# å·¥ä½œå°æ¨¡å— - API æ¥å£è¯´æ˜

## æ¦‚è¿°
å·¥ä½œå°æ¨¡å—è´Ÿè´£å±•ç¤ºåŒ»ç”Ÿçš„å·¥ä½œçŠ¶æ€ã€ç­¾åˆ°ç­¾é€€ã€ç­æ¬¡ä¿¡æ¯ã€æ¥è¯Šæ•°æ®ç­‰æ ¸å¿ƒä¸šåŠ¡åŠŸèƒ½ã€‚

## ç»Ÿä¸€è¿”å›æ ¼å¼

### æˆåŠŸå“åº”ï¼ˆcode = 0ï¼‰
```json
{
  "code": 0,
  "message": {
    // å…·ä½“æ•°æ®
  }
}
```

### å¤±è´¥å“åº”ï¼ˆcode â‰  0ï¼‰
```json
{
  "code": 1,
  "message": "é”™è¯¯æè¿°ä¿¡æ¯"
}
```

---

## API æ¥å£åˆ—è¡¨

### 1. è·å–å·¥ä½œå°é¦–é¡µæ•°æ®
**æ¥å£åç§°**: è·å–å·¥ä½œå°æ•°æ®  
**è¯·æ±‚æ–¹å¼**: `GET`  
**è¯·æ±‚åœ°å€**: `/api/workbench/dashboard`  
**æè¿°**: è·å–å·¥ä½œå°é¦–é¡µæ‰€æœ‰æ•°æ®ï¼ˆåŒ»ç”Ÿä¿¡æ¯ã€ç­æ¬¡ã€æ¥è¯Šæ•°æ®ç­‰ï¼‰

#### å“åº”ç¤ºä¾‹
```json
{
  "code": 0,
  "message": {
    "doctor": {
      "id": 1,
      "name": "é™ˆæ˜å“²",
      "title": "æ•™æˆã€ä¸»ä»»åŒ»å¸ˆ",
      "department": "å¿ƒå†…ç§‘",
      "photo_path": "/static/images/doctor/doctor_1.jpg"
    },
    "shiftStatus": {
      "status": "not_checkin",
      "currentShift": {
        "id": 1,
        "name": "ä¸Šåˆé—¨è¯Š",
        "startTime": "08:30",
        "endTime": "12:00",
        "location": "é—¨è¯Š3è¯Šå®¤",
        "countdown": "è·ç¦»å¼€å§‹è¿˜æœ‰ 15 åˆ†é’Ÿ"
      },
      "checkinTime": null,
      "checkoutTime": null,
      "workDuration": null
    },
    "todayData": {
      "pendingConsultation": 3,
      "ongoingConsultation": 2,
      "completedConsultation": 15,
      "totalConsultation": 20
    },
    "reminders": [
      {
        "id": 1,
        "type": "patient_arrival",
        "title": "3ä½æ‚£è€…å³å°†åˆ°è¾¾",
        "time": "10:30"
      }
    ],
    "recentRecords": [
      {
        "id": 1,
        "patientName": "ææ˜",
        "consultationTime": "09:30",
        "diagnosis": "é«˜è¡€å‹"
      }
    ]
  }
}
```

---

### 2. åŒ»ç”Ÿç­¾åˆ°
**æ¥å£åç§°**: ç­¾åˆ°  
**è¯·æ±‚æ–¹å¼**: `POST`  
**è¯·æ±‚åœ°å€**: `/api/workbench/checkin`  
**æè¿°**: åŒ»ç”Ÿç­¾åˆ°ï¼Œéœ€è¦å®šä½ä¿¡æ¯

#### è¯·æ±‚å‚æ•°
| å‚æ•°å | ç±»å‹ | å¿…éœ€ | æè¿° |
|--------|------|------|------|
| `latitude` | number | æ˜¯ | çº¬åº¦ |
| `longitude` | number | æ˜¯ | ç»åº¦ |
| `shiftId` | number | æ˜¯ | ç­æ¬¡ ID |

#### è¯·æ±‚ç¤ºä¾‹
```json
{
  "latitude": 39.9042,
  "longitude": 116.4074,
  "shiftId": 1
}
```

#### å“åº”ç¤ºä¾‹
```json
{
  "code": 0,
  "message": {
    "checkinTime": "08:28",
    "status": "checked_in",
    "message": "ç­¾åˆ°æˆåŠŸ"
  }
}
```

---

### 3. åŒ»ç”Ÿç­¾é€€
**æ¥å£åç§°**: ç­¾é€€  
**è¯·æ±‚æ–¹å¼**: `POST`  
**è¯·æ±‚åœ°å€**: `/api/workbench/checkout`  
**æè¿°**: åŒ»ç”Ÿç­¾é€€ï¼Œéœ€è¦å®šä½ä¿¡æ¯

#### è¯·æ±‚å‚æ•°
| å‚æ•°å | ç±»å‹ | å¿…éœ€ | æè¿° |
|--------|------|------|------|
| `latitude` | number | æ˜¯ | çº¬åº¦ |
| `longitude` | number | æ˜¯ | ç»åº¦ |
| `shiftId` | number | æ˜¯ | ç­æ¬¡ ID |

#### å“åº”ç¤ºä¾‹
```json
{
  "code": 0,
  "message": {
    "checkoutTime": "12:15",
    "workDuration": "3å°æ—¶47åˆ†é’Ÿ",
    "status": "checked_out",
    "message": "ç­¾é€€æˆåŠŸ"
  }
}
```

---

### 4. è·å–ç­æ¬¡ä¿¡æ¯
**æ¥å£åç§°**: è·å–ç­æ¬¡ä¿¡æ¯  
**è¯·æ±‚æ–¹å¼**: `GET`  
**è¯·æ±‚åœ°å€**: `/api/workbench/shifts`  
**æè¿°**: è·å–åŒ»ç”Ÿä»Šæ—¥ç­æ¬¡åˆ—è¡¨

#### æŸ¥è¯¢å‚æ•°
| å‚æ•°å | ç±»å‹ | å¿…éœ€ | æè¿° |
|--------|------|------|------|
| `doctorId` | number | æ˜¯ | åŒ»ç”Ÿ ID |
| `date` | string | å¦ | æ—¥æœŸï¼Œæ ¼å¼ YYYY-MM-DDï¼ˆé»˜è®¤ä»Šå¤©ï¼‰ |

#### å“åº”ç¤ºä¾‹
```json
{
  "code": 0,
  "message": {
    "shifts": [
      {
        "id": 1,
        "name": "ä¸Šåˆé—¨è¯Š",
        "startTime": "08:30",
        "endTime": "12:00",
        "location": "é—¨è¯Š3è¯Šå®¤",
        "status": "not_started"
      },
      {
        "id": 2,
        "name": "ä¸‹åˆé—¨è¯Š",
        "startTime": "14:00",
        "endTime": "17:30",
        "location": "é—¨è¯Š5è¯Šå®¤",
        "status": "not_started"
      }
    ]
  }
}
```

---

### 5. è·å–ä»Šæ—¥æ¥è¯Šæ•°æ®
**æ¥å£åç§°**: è·å–æ¥è¯Šç»Ÿè®¡  
**è¯·æ±‚æ–¹å¼**: `GET`  
**è¯·æ±‚åœ°å€**: `/api/workbench/consultation-stats`  
**æè¿°**: è·å–åŒ»ç”Ÿä»Šæ—¥æ¥è¯Šæ•°æ®ç»Ÿè®¡

#### æŸ¥è¯¢å‚æ•°
| å‚æ•°å | ç±»å‹ | å¿…éœ€ | æè¿° |
|--------|------|------|------|
| `doctorId` | number | æ˜¯ | åŒ»ç”Ÿ ID |

#### å“åº”ç¤ºä¾‹
```json
{
  "code": 0,
  "message": {
    "pending": 3,
    "ongoing": 2,
    "completed": 15,
    "total": 20
  }
}
```

---

### 6. è·å–å¾…åŠæé†’
**æ¥å£åç§°**: è·å–æé†’åˆ—è¡¨  
**è¯·æ±‚æ–¹å¼**: `GET`  
**è¯·æ±‚åœ°å€**: `/api/workbench/reminders`  
**æè¿°**: è·å–åŒ»ç”Ÿçš„å¾…åŠæé†’

#### æŸ¥è¯¢å‚æ•°
| å‚æ•°å | ç±»å‹ | å¿…éœ€ | æè¿° |
|--------|------|------|------|
| `doctorId` | number | æ˜¯ | åŒ»ç”Ÿ ID |

#### å“åº”ç¤ºä¾‹
```json
{
  "code": 0,
  "message": {
    "reminders": [
      {
        "id": 1,
        "type": "patient_arrival",
        "title": "3ä½æ‚£è€…å³å°†åˆ°è¾¾",
        "icon": "ğŸš¨",
        "time": "10:30"
      },
      {
        "id": 2,
        "type": "meeting",
        "title": "åŒ»å­¦è®¨è®ºä¼š",
        "icon": "ğŸ“…",
        "time": "14:00"
      }
    ]
  }
}
```

---

### 7. è·å–æœ€è¿‘æ¥è¯Šè®°å½•
**æ¥å£åç§°**: è·å–æ¥è¯Šè®°å½•  
**è¯·æ±‚æ–¹å¼**: `GET`  
**è¯·æ±‚åœ°å€**: `/api/workbench/recent-consultations`  
**æè¿°**: è·å–åŒ»ç”Ÿæœ€è¿‘çš„æ¥è¯Šè®°å½•

#### æŸ¥è¯¢å‚æ•°
| å‚æ•°å | ç±»å‹ | å¿…éœ€ | æè¿° |
|--------|------|------|------|
| `doctorId` | number | æ˜¯ | åŒ»ç”Ÿ ID |
| `limit` | number | å¦ | è¿”å›è®°å½•æ•°ï¼ˆé»˜è®¤ 3ï¼‰ |

#### å“åº”ç¤ºä¾‹
```json
{
  "code": 0,
  "message": {
    "records": [
      {
        "id": 1,
        "patientName": "ææ˜",
        "patientId": 101,
        "consultationTime": "09:30",
        "diagnosis": "é«˜è¡€å‹ï¼Œéœ€æ§åˆ¶é¥®é£Ÿ",
        "status": "completed"
      },
      {
        "id": 2,
        "patientName": "ç‹èŠ³",
        "patientId": 102,
        "consultationTime": "09:50",
        "diagnosis": "å¿ƒå¾‹ä¸é½ï¼Œå»ºè®®å¤æŸ¥",
        "status": "completed"
      }
    ]
  }
}
```

---

## é”™è¯¯å¤„ç†

| é”™è¯¯ä»£ç  | æè¿° | å¤„ç†å»ºè®® |
|---------|------|---------|
| 0 | æˆåŠŸ | æ­£å¸¸å¤„ç†å“åº”æ•°æ® |
| 1 | é€šç”¨é”™è¯¯ | æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯æç¤º |
| 401 | æœªæˆæƒï¼ˆç™»å½•è¿‡æœŸï¼‰ | è·³è½¬åˆ°ç™»å½•é¡µ |
| 403 | ç¦æ­¢è®¿é—® | æ˜¾ç¤ºæƒé™ä¸è¶³æç¤º |
| 404 | èµ„æºä¸å­˜åœ¨ | æ˜¾ç¤ºæ•°æ®ä¸å­˜åœ¨æç¤º |
| 500 | æœåŠ¡å™¨é”™è¯¯ | æ˜¾ç¤ºæœåŠ¡å™¨ç¹å¿™æç¤º |

---

## ä¸šåŠ¡è§„åˆ™

### ç­¾åˆ°è§„åˆ™
- ç­¾åˆ°å‰éœ€è·å–è®¾å¤‡å®šä½ä¿¡æ¯
- ç­¾åˆ°æ—¶é—´ï¼šç­æ¬¡å¼€å§‹æ—¶é—´å‰å30åˆ†é’Ÿå†…å…è®¸ç­¾åˆ°
- ç­¾åˆ°éœ€å­˜å‚¨çº¬åº¦ã€ç»åº¦ã€ç­¾åˆ°æ—¶é—´ã€è®¾å¤‡IDç­‰ä¿¡æ¯

### ç­¾é€€è§„åˆ™
- å¿…é¡»å…ˆç­¾åˆ°æ‰èƒ½ç­¾é€€
- ç­¾é€€æ—¶é—´ï¼šç­æ¬¡ç»“æŸæ—¶é—´å‰å15åˆ†é’Ÿå†…å…è®¸ç­¾é€€
- ç­¾é€€æˆåŠŸåè‡ªåŠ¨è®¡ç®—å·¥ä½œæ—¶é•¿

### ç­æ¬¡çŠ¶æ€
- `not_started`: æœªå¼€å§‹
- `checking_in`: å·²ç­¾åˆ°ï¼Œå·¥ä½œä¸­
- `checkout_pending`: å¾…ç­¾é€€
- `checked_out`: å·²ç­¾é€€

---

## æ–‡ä»¶è·¯å¾„
- API è°ƒç”¨æ–‡ä»¶: `/src/api/workbench.js`
- Mock æ•°æ®æ–‡ä»¶: `/src/api/workbench-mock.js`
- é¡µé¢æ–‡ä»¶: `/src/views/workbench/index.vue`
- å­ç»„ä»¶ç›®å½•: `/src/views/workbench/components/`

---

**æœ€åæ›´æ–°**: 2025-11-19
